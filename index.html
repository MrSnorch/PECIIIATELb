<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–†–ï–®–ê–¢–ï–õ–¨ üé∞</title>

<style>
* { box-sizing: border-box; }

body {
    margin: 0;
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    font-family: system-ui, -apple-system, Segoe UI, Arial, sans-serif;
    background: radial-gradient(circle at top, #1b1f2a, #07080d);
    color: #fff;
}

.box {
    width: 100%;
    max-width: 460px;
    background: rgba(20,24,36,.8);
    backdrop-filter: blur(14px);
    border-radius: 26px;
    padding: 26px;
    box-shadow: 0 35px 70px rgba(0,0,0,.75);
}

h1 { text-align:center; margin-bottom:18px; }

/* GRID */
.grid {
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:14px;
}

.card {
    background: rgba(255,255,255,.04);
    border-radius:18px;
    padding:16px;
    text-align:center;
    position: relative;
}

.visual {
    font-size:60px;
    user-select:none;
}

/* SETTINGS */
.settings-btn{
    position:absolute;
    top:8px;
    right:8px;
    width:auto !important;
    margin:0;
    padding:4px 6px;
    font-size:13px;
    line-height:1;
    border-radius:8px;
    border:none;
    background:rgba(255,255,255,.12);
    color:#fff;
    cursor:pointer;
}
.settings{
    display:none;
    margin-top:8px;
    background:rgba(0,0,0,.35);
    padding:8px;
    border-radius:10px;
    font-size:13px;
    text-align:left;
}
.settings label{display:block;margin-bottom:6px}
.settings input{
    width:100%;
    padding:6px;
    border-radius:8px;
    border:none;
}

/* BUTTON */
button {
    width:100%;
    margin-top:8px;
    padding:12px;
    border-radius:14px;
    border:none;
    cursor:pointer;
    font-weight:600;
    color:#eaf0ff;
    background: linear-gradient(135deg,#2a3355,#1a2140);
}

/* ANIMATIONS */
.coin.flip { animation: flip .9s ease-in-out; }
@keyframes flip {
    0% { transform: rotateY(0); }
    50% { transform: rotateY(540deg) scale(1.1); }
    100% { transform: rotateY(1080deg); }
}

.dice.roll { animation: roll .6s ease-out; }
@keyframes roll {
    0% { transform: rotate(0); }
    40% { transform: rotate(180deg) scale(1.2); }
    100% { transform: rotate(360deg); }
}

/* RESULT */
.result {
    margin-top:14px;
    text-align:center;
    min-height:34px;
    opacity:0;
    transform:translateY(14px);
    transition:.4s;
    white-space: normal;
    word-break: break-word;
    overflow-wrap: anywhere;
}
.result.show {
    opacity:1;
    transform:translateY(0);
}

.movie { color:#ffd66b; font-weight:600; }

/* WHEEL */
.wheel-box { margin-top:20px; text-align:center; }
canvas { display:block; margin:10px auto; }

.arrow {
    margin:-6px auto 0;
    width:0;height:0;
    border-left:10px solid transparent;
    border-right:10px solid transparent;
    border-top:18px solid #ffd66b;
}

input {
    width:100%;
    margin-top:6px;
    padding:10px;
    border-radius:10px;
    border:none;
}

.controls {
    display:flex;
    gap:8px;
    margin-top:8px;
}
.controls button { flex:1; }

.history {
    margin-top:14px;
    background: rgba(255,255,255,.04);
    border-radius:14px;
    padding:10px;
    max-height:120px;
    overflow:auto;
}

@media(max-width:420px){
    .grid{grid-template-columns:1fr;}
}
</style>
</head>

<body>
<div class="box">
<h1>üé∞ –†–ï–®–ê–¢–ï–õ–¨</h1>

<div class="grid">
    <div class="card">
        <button class="settings-btn" onclick="toggle('coinSettings')">‚öôÔ∏è</button>
        <div class="visual coin" id="coin">ü™ô</div>

        <div class="settings" id="coinSettings">
            <label>–û—Ä—ë–ª
                <input id="eagleText" value="üé¨ –ö–ò–ù–û">
            </label>
            <label>–†–µ—à–∫–∞
                <input id="tailsText" value="üì∫ YouTube">
            </label>
        </div>

        <button onclick="coinFlip()">–ú–æ–Ω–µ—Ç–∫–∞</button>
    </div>

    <div class="card">
        <button class="settings-btn" onclick="toggle('diceSettings')">‚öôÔ∏è</button>
        <div class="visual dice" id="dice">üé≤</div>

        <div class="settings" id="diceSettings">
            <label>–ú–∏–Ω–∏–º—É–º
                <input type="number" id="diceMin" value="1">
            </label>
            <label>–ú–∞–∫—Å–∏–º—É–º
                <input type="number" id="diceMax" value="3">
            </label>
        </div>

        <button onclick="rollDice()">–ö—É–±–∏–∫</button>
    </div>
</div>

<div class="wheel-box">
    <h3>üé° –ö–æ–ª–µ—Å–æ —Ñ–æ—Ä—Ç—É–Ω—ã</h3>
    <div class="arrow"></div>
    <canvas id="wheel" width="260" height="260"></canvas>

    <input id="sectorInput" placeholder="–¢–µ–∫—Å—Ç —Å–µ–∫—Ç–æ—Ä–∞">
    <div class="controls">
        <button onclick="addSector()">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
        <button onclick="resetWheel()">üîÑ –°–±—Ä–æ—Å</button>
    </div>

    <button style="margin-top:10px" onclick="spinWheel()">üé∞ –ö–†–£–¢–ò–¢–¨</button>

    <div class="history">
        <ul id="historyList"></ul>
    </div>
</div>

<div class="result" id="result"></div>
</div>

<script>
/* UI */
function toggle(id){
    const el=document.getElementById(id);
    el.style.display = el.style.display==="block" ? "none" : "block";
}
function show(html){
    const r=document.getElementById('result');
    r.classList.remove('show');
    r.innerHTML=html;
    requestAnimationFrame(()=>r.classList.add('show'));
}

/* AUDIO */
const audio = new (window.AudioContext || window.webkitAudioContext)();

/* COIN SOUND */
function coinSound(){
    const o=audio.createOscillator(), g=audio.createGain();
    o.type="triangle";
    o.frequency.setValueAtTime(1800,audio.currentTime);
    o.frequency.exponentialRampToValueAtTime(2600,audio.currentTime+0.08);
    g.gain.value=0.12;
    o.connect(g).connect(audio.destination);
    o.start(); o.stop(audio.currentTime+0.09);
}

/* DICE SOUND */
function diceSound(){
    for(let i=0;i<3;i++){
        setTimeout(()=>{
            const o=audio.createOscillator(), g=audio.createGain();
            o.type="square";
            o.frequency.value=400+Math.random()*200;
            g.gain.value=0.06;
            o.connect(g).connect(audio.destination);
            o.start(); o.stop(audio.currentTime+0.05);
        },i*60);
    }
}

/* COIN / DICE */
function coinFlip(){
    const coin=document.getElementById('coin');
    coin.classList.remove('flip'); void coin.offsetWidth; coin.classList.add('flip');
    coinSound();

    show(Math.random()<.5
        ? `ü™ô –û—Ä—ë–ª ‚Üí <span class="movie">${eagleText.value}</span>`
        : `ü™ô –†–µ—à–∫–∞ ‚Üí <span class="movie">${tailsText.value}</span>`
    );
}

function rollDice(){
    const dice=document.getElementById('dice');
    dice.classList.remove('roll'); void dice.offsetWidth; dice.classList.add('roll');
    diceSound();

    const min=+diceMin.value, max=+diceMax.value;
    if(min>max) return show("‚ö†Ô∏è –ù–µ–≤–µ—Ä–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω");

    const n=Math.floor(Math.random()*(max-min+1))+min;
    show(`üé≤ –ö–æ—Å—Ç–∏ –±—Ä–æ—à–µ–Ω—ã‚Ä¶ –≤—ã–ø–∞–ª–æ <span class="movie">${n}</span>`);
}

/* WHEEL */
const canvas=document.getElementById('wheel');
const c=canvas.getContext('2d');

let sectors=[];
let history=[];
let angle=0,spinning=false,lastIndex=null;

function sectorClick(){
    const o=audio.createOscillator(), g=audio.createGain();
    o.type="square";
    o.frequency.value=900;
    g.gain.value=0.08;
    o.connect(g).connect(audio.destination);
    o.start(); o.stop(audio.currentTime+0.03);
}

function finalStop(){
    const now = audio.currentTime;
    const o1 = audio.createOscillator(), g1 = audio.createGain();
    const o2 = audio.createOscillator(), g2 = audio.createGain();
    o1.frequency.setValueAtTime(1200, now);
    o2.frequency.setValueAtTime(1800, now);
    g1.gain.setValueAtTime(0.18, now);
    g2.gain.setValueAtTime(0.1, now);
    g1.gain.exponentialRampToValueAtTime(0.001, now + 0.6);
    g2.gain.exponentialRampToValueAtTime(0.001, now + 0.5);
    o1.connect(g1).connect(audio.destination);
    o2.connect(g2).connect(audio.destination);
    o1.start(now); o2.start(now);
    o1.stop(now + 0.7); o2.stop(now + 0.6);
}

function draw(){
    c.clearRect(0,0,260,260);

    const cx=130,cy=130,r=130;

    if(sectors.length){
        const step=2*Math.PI/sectors.length;
        sectors.forEach((text,i)=>{
            c.beginPath();
            c.moveTo(cx,cy);
            c.fillStyle=`hsl(${i*360/sectors.length},70%,45%)`;
            c.arc(cx,cy,r,i*step+angle,(i+1)*step+angle);
            c.fill();

            c.save();
            c.translate(cx,cy);
            c.rotate(i*step+step/2+angle);
            c.fillStyle="#fff";
            c.font="14px sans-serif";
            c.textAlign="right";

            let label=text;
            while(c.measureText(label+'‚Ä¶').width>95 && label.length){
                label=label.slice(0,-1);
            }
            if(label!==text) label+='‚Ä¶';

            c.fillText(label,r-15,5);
            c.restore();
        });
    }

    /* –û–ë–í–û–î–ö–ê ‚Äî –í–°–ï–ì–î–ê */
    c.beginPath();
    c.arc(cx, cy, r-1, 0, Math.PI*2);
    c.strokeStyle = "#ffd66b";
    c.lineWidth = 2;
    c.shadowColor = "rgba(255,214,107,.5)";
    c.shadowBlur = 4;
    c.stroke();
    c.shadowBlur = 0;
}
draw();

function spinWheel(){
    if(sectors.length<2||spinning) return;
    spinning=true; lastIndex=null;

    let speed=Math.random()*0.4+0.3;
    const dec=0.985;

    const spin=setInterval(()=>{
        angle+=speed;
        speed*=dec;
        draw();

        const step=2*Math.PI/sectors.length;
        const norm=(2*Math.PI-(angle%(2*Math.PI)))%(2*Math.PI);
        const idx=Math.floor(norm/step);

        if(idx!==lastIndex){
            sectorClick();
            lastIndex=idx;
        }

        if(speed<0.005){
            clearInterval(spin);
            spinning=false;

            const result=sectors.splice(idx,1)[0];
            history.push(result);
            updateHistory();
            draw();
            finalStop();
            show(`üé° –í—ã–ø–∞–ª–æ: <span class="movie">${result}</span>`);
        }
    },20);
}

function addSector(){
    const v=sectorInput.value.trim();
    if(!v) return;
    sectors.push(v);
    sectorInput.value='';
    draw();
}

function resetWheel(){
    sectors=[]; history=[];
    updateHistory(); draw();
}

function updateHistory(){
    historyList.innerHTML='';
    history.forEach((h,i)=>{
        const li=document.createElement('li');
        li.textContent=`${i+1}. ${h}`;
        historyList.appendChild(li);
    });
}
</script>
</body>
</html>
